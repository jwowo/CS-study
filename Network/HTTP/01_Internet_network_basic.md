# 인터넷 네트워크

## IP(인터넷 프로토콜)

- 복잡한 인터넷 망에서 컴퓨터는 IP주소를 부여받아 서로 통신한다. 

#### IP(인터넷 프로토콜)의 역할
  - 지정한 `IP주소(IP Address)`에 데이터를 전달
  - `패킷(Packet)`이라는 통신 단위로 데이터 전달

- `IP 패킷`에는 `출발지 IP`, `목적지 IP`, `전송 데이터` 등이 있다.
- 클라이언트에서 전달한 패킷은 인터넷을 통해 여러 노드들을 거쳐서 서버에 전달된다.
- 패킷에는 출발지 IP 정보와 목적지 IP 등이 있으므로, 클라이언트에서 전송된 데이터를 받은 서버에서는 요청된 작업을 완료한 후에 다시 클라이언트에게 패킷을 전달할 수 있다.

#### IP 프로토콜의 한계
  - 비 연결성 : 패킷을 받을 대상이 없거나 서비스 불능 상태여도 패킷을 전송한다.
  - 비신뢰성 : 중간에 패킷이 사라지거나(소실) 패킷의 순서가 바뀐채로 도착해도 알 수 없다.
  - 프로그램 구분 : 같은 IP를 사용하는 서버에서 사용중인 애플리케이션이 여러개라면 어떤 애플리케이션에 패킷을 전송해야하는지 알 수 없다.

## TCP, UDP

- IP 프로토콜의 한계를 보완하기 인터넷 프로토콜 스택 4계층의 IP 프로토콜 위에 TCP와 UDP 프로토콜이 있다.

![image](https://user-images.githubusercontent.com/72483138/146954000-10a9ddd0-b665-4a9f-884f-fc958a6d1042.png)

- 기존의 IP 프로토콜의 패킷은 출발지 IP와 목적지 IP, 전송 데이터를 포함하였다면,
`TCP/IP 패킷` 정보에는 `출발지 PORT`, `목적지 PORT`, `전송 제어`, `순서, 검증 정보`등의 데이터를 포함한다.

![image](https://user-images.githubusercontent.com/72483138/146954903-536e5394-58b2-424a-bb56-50353b5dd330.png)

#### TCP 특징 (전송 제어 프로토콜, Transmission Control Portocol)
  - 연결 지향 : `TCP 3 way handshake`를 통한 가상 연결(물리적인 연결은 아님)
  - 데이터 전달 보증
  - 순서 보장
  - 신뢰할 수 있는 프로토콜
  - 현재는 대부분 TCP 프로토콜을 사용

#### TCP 3 way handshake
  ![image](https://user-images.githubusercontent.com/72483138/146955259-ec38b638-454c-4e86-8a98-41207917fbb1.png)
  - TCP는 클라이언트-서버의 연결을 지향하기 때문에 서로 연결이 되었는지 확인하고 패킷을 전송한다. 연결이 되었는지를 확인하기 위해 3 way handshake를 한다. 
  1. 클라이언트가 서버에게 `SYN` 을 보냄
  2. 서버는 클라이언트에게 `SYN`을 받았다는 `SYN + ACK`를 보냄
  3. 클라이언트는 다시 서버에게 `ACK`을 받았다는 `ACK`을 보내고 데이터를 전송한다.

#### 데이터 전달 보증
  - 클라이언트가 서버에게 데이터를 전송하면, 서버는 데이터를 잘 받았다고 알려준다.

#### 순서 보장
  - 클라이언트가 서버에게 `패킷 1`, `패킷 2`, `패킷 3`의 순서로 서버에 전송했을때, 서버가 `패킷 1`, `패킷 3`, `패킷 2`의 순서로 패킷을 받았다면, 서버는 클라이언트에게 `패킷 2`부터 다시 보내라고 전송한다. (이는 서버 내부의 구조 및 최적화에 따라 다를 수 있다)

#### UDP 특징(사용자 데이터그램 프로토콜, User Datagram, Protocol)
  - TCP에 비해 연결 지향 X, 순서 보장 X, 데이터 전달 및 순서가 보장되지 않지만 단순하고 빠르다. (동영상과 같이 조금 데이터가 유실되더라도 빠르게 전송이 되어야 하는 데이터를 전송할 때 쓰임)
  - IP 프로토콜과 거의 비슷하고 PORT와 체크섬(데이터 무결성 확인) 정도만 추가되어 있다. 
  - UDP는 기능이 거의 없는 도화지와 같아서 요즘에는 UDP 상위에 프로토콜을 직접 만들어서 원하는 프로토콜로 사용하기도 한다.

## PORT
- 서버 하나에 여러개의 클라이언트와 연결을 해야한다면 어떻게 할까?
`TCP/IP 패킷`에는 `출발지 IP`, `목적지 IP`와 함께 `출발지 PORT`와 `목적지 PORT`도 함께 전송한다. 
- `PORT`는 같은 IP 내에서 프로세스의 구분을 한다. IP 통신을 통해 원하는 서버 주소로 잘 전달했지만 어떤 애플리케이션에 전송해야할지 모를때 `PORT`를 통해 원하는 애플리케이션에 연결을 한다.
- `0 ~ 65535` : 할당 가능한 포트 번호
`0 ~ 1023` : Well known port, 사용하지 않는 것이 좋다.

## DNS
- IP는 ipv4의 경우 8비트 숫자 4개로 이루어져있는데, 이는 사람이 기억하기 힘들다.
- 또한 IP는 변경될 수 있다.
- 따라서 인터넷은 `DNS(Domain Name System)`을 통해 ip 주소를 관리한다.
- DNS는 일종의 전화번호부로 도메인 이름을 IP 주소로 변환한다. 
  - ex) www.naver.com -> xxx.xxx.xxx.xxx
- 클라이언트가 DNS에 naver.com의 ip주소를 요청하면 DNS 서버는 클라이언트에게 해당되는 IP 주소를 보내준다. 이 ip주소를 통해 클라이언트는 naver.com에 접속을 할 수 있게 된다.